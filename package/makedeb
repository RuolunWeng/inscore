
arch	:= $(shell arch)
dist	:= ubuntu-maverick
package := INScore-$(version)-$(dist)-$(arch).deb
viewer	:= INScoreViewer
lib		:= libINScore.so

files = $(shell cd debian && find usr -type f)

deb:
	rm -f debian/usr/bin/*
	cp ../cmake/$(viewer)-$(version) debian/usr/bin
	cd debian/usr/bin && ln -s $(viewer)-$(version) $(viewer)
	rm -f debian/usr/lib/*
	cp ../cmake/$(lib).$(version) debian/usr/lib
	cd debian/usr/lib && ln -s $(lib).$(version) $(lib)
	rm -rf debian/usr/share/inscore/*
	cp -r INScore-$(version)/* debian/usr/share/inscore
	@echo compute md5sums
	@cd debian && md5sum $(files) > DEBIAN/md5sums
	fakeroot dpkg-deb --build debian
	mv debian.deb $(package)

clean:
	rm -f debian/usr/bin/*
	rm -f debian/usr/lib/*
	rm -f debian/DEBIAN/md5sums
	rm -rf debian/usr/share/inscore/*

