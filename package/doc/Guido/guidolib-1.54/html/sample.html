<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>GUIDOLib: Sample code</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.2 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Sample code </h1>  </div>
</div>
<div class="contents">
<p>This section provides examples of the GUIDO library use.</p>
<h2><a class="anchor" id="ex1"></a>
Displaying a score</h2>
<div class="fragment"><pre class="fragment">
<span class="preprocessor">#include &lt;iostream&gt;</span>

<span class="preprocessor">#include &quot;<a class="code" href="GUIDOEngine_8h.html">GUIDOEngine.h</a>&quot;</span>
<span class="preprocessor">#include &quot;GDevicePostScript.h&quot;</span>

<span class="keyword">using namespace </span>std;
<span class="comment">// ---------------------------------------------------------------------------</span>
<span class="comment">//  This example of code is intended to show the minimum steps to read a</span>
<span class="comment">//  GMN file and to display it.</span>
<span class="comment">//  Take care that for simplicity, this example doesn&#39;t check return codes</span>
<span class="comment">// ---------------------------------------------------------------------------</span>
<span class="keywordtype">void</span> DrawGMNFile (<span class="keyword">const</span> <span class="keywordtype">char</span> * filename) 
{
    <a class="code" href="GUIDOEngine_8h.html#a865921dc2e7e22bd4ae210b8b57cc512">ARHandler</a> arh;
    <span class="comment">// use a GDevicePostScript with a 72 dpi resolution</span>
    GDevicePostScript dev ((<span class="keywordtype">int</span>)(21*72/2.54), (<span class="keywordtype">int</span>)(29.7*72/2.54), <span class="stringliteral">&quot;outfile.eps&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);
    
    <span class="comment">// declare a data structure for engine initialisation</span>
    <span class="comment">// we&#39;ll make use of the default graphic device (embedded in the library)</span>
    <span class="comment">// Guido font is guido2 and text font is times</span>
    <a class="code" href="structGuidoInitDesc.html" title="The GuidoInitDesc data structure contains all information required by GuidoInit()">GuidoInitDesc</a> gd = { &amp;dev, 0, <span class="stringliteral">&quot;guido2&quot;</span>, <span class="stringliteral">&quot;Times&quot;</span> };
    <a class="code" href="structGuidoOnDrawDesc.html" title="Contains all graphic-related information required by GuidoOnDraw()">GuidoOnDrawDesc</a> desc;              <span class="comment">// declare a data structure for drawing        </span>
    <a class="code" href="group__Engine.html#ga1012288f8d055a8dc3c4b2e3572b4b11">GuidoInit</a> (&amp;gd);                   <span class="comment">// Initialise the Guido Engine first</span>
    
    <span class="comment">// and parse the GMN file to get a GGR handle directly stored in the drawing struct</span>
    <a class="code" href="group__Engine.html#gadd96c9ae0880a8580f9455ab1bd57a1f">GuidoParseFile</a> (filename, &amp;arh);
    <a class="code" href="group__Engine.html#ga04ffb5395717ddda32863dfab77a1624">GuidoAR2GR</a> (arh, 0, &amp;desc.<a class="code" href="structGuidoOnDrawDesc.html#accd0f35f6230e33ac22ef7963def604a" title="A Guido handler to a graphic representation.">handle</a>);
    desc.<a class="code" href="structGuidoOnDrawDesc.html#aa8be78ce75fc8fc4590ba27f580a7da6" title="A graphic device context.">hdc</a> = &amp;dev;                    <span class="comment">// we&#39;ll draw on the postscript device</span>
    desc.<a class="code" href="structGuidoOnDrawDesc.html#adf406aa6822ceac22d62ef63cc2879c0" title="The page number. Starts from 1.">page</a> = 1;                      <span class="comment">// draw the first page only</span>
    desc.<a class="code" href="structGuidoOnDrawDesc.html#ae9eeb40ceed7d16cfc449944ae84d15b" title="Indicates what to (re)draw.">updateRegion</a>.<a class="code" href="structGPaintStruct.html#a4ca12c532cc40482637d222eb4698eb1" title="a flag to ignore the following rect and to redraw everything">erase</a> = <span class="keyword">true</span>;     <span class="comment">// and draw everything</span>
    desc.<a class="code" href="structGuidoOnDrawDesc.html#a875722d56e9e4d54cd10f78f74e980a1">scrollx</a> = desc.<a class="code" href="structGuidoOnDrawDesc.html#ad26dc0e87c101ecd8f054afa6782e797">scrolly</a> = 0;    <span class="comment">// from the upper left page corner</span>
    desc.<a class="code" href="structGuidoOnDrawDesc.html#a1ee51c3f8f6ff6d9c1800377aeb40c1c">sizex</a> = desc.<a class="code" href="structGuidoOnDrawDesc.html#acbb6e9e0854d48fea337fa56c1d61b69">sizey</a> = 500;      <span class="comment">// size of the drawing region</span>
    
    <a class="code" href="group__Format.html#gae2672cceed342e1d2ba43aedfdc76223" title="Draws one page of score into a graphic device.">GuidoOnDraw</a> (&amp;desc);
}

<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> **argv)
{
    <span class="keyword">const</span> <span class="keywordtype">char</span> * file = argv[1];
    DrawGMNFile (file);
    <span class="keywordflow">return</span> 0;
}
</pre></div><h2><a class="anchor" id="ex2"></a>
Building music using the GUIDO Factory</h2>
<div class="fragment"><pre class="fragment">
<span class="preprocessor">#include &quot;<a class="code" href="GUIDOFactory_8h.html">GUIDOFactory.h</a>&quot;</span>

<span class="comment">// ---------------------------------------------------------------------------</span>
<span class="comment">//  Guido Factory example of use</span>
<span class="comment">//  Take care that for simplicity, this example doesn&#39;t check return codes</span>
<span class="comment">// ---------------------------------------------------------------------------</span>
<span class="keywordtype">void</span> TestGuidoFactory() 
{
    <a class="code" href="GUIDOEngine_8h.html#a865921dc2e7e22bd4ae210b8b57cc512">ARHandler</a> ar; <a class="code" href="GUIDOEngine_8h.html#a7b2b7688c61d1912604dd4d29aff6eb4">GRHandler</a> gr;
    <a class="code" href="group__Factory.html#ga3c74a39e034bb956a5cd1b1547f31f1a">ARFactoryHandler</a> *f;
    
    <a class="code" href="group__Factory.html#gae304437315d93277e576f127f50f979b" title="Opens the Guido Factory.">GuidoFactoryOpen</a>(&amp;f);               <span class="comment">// open the GUIDO Factory first</span>
    
    <a class="code" href="group__Factory.html#gae0daab4fc7fbff081268a4264ae53371" title="Creates and opens a new music score.">GuidoFactoryOpenMusic</a>(f);           <span class="comment">// and create a new score   </span>
    <a class="code" href="group__Factory.html#ga838125f5d84f52a998d298926712cc78" title="Creates and opens a new voice.">GuidoFactoryOpenVoice</a>(f);           <span class="comment">// open a new voice</span>

    <a class="code" href="group__Factory.html#gaf21d51352a88fe015613d7b8d418f671" title="Creates and opens a new event (note or rest).">GuidoFactoryOpenEvent</a>(f, <span class="stringliteral">&quot;c&quot;</span> );     <span class="comment">// open a new note</span>
    <a class="code" href="group__Factory.html#ga10f5828da61b416ab477544308492056" title="Closes the current event.">GuidoFactoryCloseEvent</a>(f);          <span class="comment">// close the note which is now part of the opened voice</span>
    
    <a class="code" href="group__Factory.html#gaf21d51352a88fe015613d7b8d418f671" title="Creates and opens a new event (note or rest).">GuidoFactoryOpenEvent</a>(f, <span class="stringliteral">&quot;e&quot;</span> );     <span class="comment">// open another new note</span>
    <a class="code" href="group__Factory.html#gaabb49574c0d6d0156c49e5445e285a01" title="Adds a sharp to the current event.">GuidoFactoryAddSharp</a>(f);            <span class="comment">// add a sharp to the opened note</span>
    <a class="code" href="group__Factory.html#ga10f5828da61b416ab477544308492056" title="Closes the current event.">GuidoFactoryCloseEvent</a>(f);          <span class="comment">// and close the note which is now part of the opened voice</span>

    <a class="code" href="group__Factory.html#ga47fbd66f7bc894d0e00362a3c8c77151" title="Closes the current voice.">GuidoFactoryCloseVoice</a>(f);          <span class="comment">// close the voice which is now part of the opened score</span>

    
    <a class="code" href="group__Factory.html#ga838125f5d84f52a998d298926712cc78" title="Creates and opens a new voice.">GuidoFactoryOpenVoice</a>(f);           <span class="comment">// open a second voice</span>
    <a class="code" href="group__Factory.html#gaf21d51352a88fe015613d7b8d418f671" title="Creates and opens a new event (note or rest).">GuidoFactoryOpenEvent</a>(f, <span class="stringliteral">&quot;a&quot;</span> );     <span class="comment">// open a new voice</span>
    <a class="code" href="group__Factory.html#ga0c88b19c9979d5f198c948dd30be6dd2" title="Add a flat to the current event.">GuidoFactoryAddFlat</a>(f);             <span class="comment">// add a flat to the opened note</span>
    <a class="code" href="group__Factory.html#ga10f5828da61b416ab477544308492056" title="Closes the current event.">GuidoFactoryCloseEvent</a>(f);          <span class="comment">// and close the note which is now part of the second voice</span>

    <a class="code" href="group__Factory.html#gaf21d51352a88fe015613d7b8d418f671" title="Creates and opens a new event (note or rest).">GuidoFactoryOpenEvent</a>(f, <span class="stringliteral">&quot;d&quot;</span> );     <span class="comment">// open another new note</span>
    <a class="code" href="group__Factory.html#ga10f5828da61b416ab477544308492056" title="Closes the current event.">GuidoFactoryCloseEvent</a>(f);          <span class="comment">// and close the note which is now part of the second voice</span>

    <a class="code" href="group__Factory.html#ga47fbd66f7bc894d0e00362a3c8c77151" title="Closes the current voice.">GuidoFactoryCloseVoice</a>(f);          <span class="comment">// close the voice which is now part of the opened score</span>
    
    <span class="comment">// - Extract AR and GR</span>
    ar = <a class="code" href="group__Factory.html#ga90a699d61ecf1867c8b738137965f47c" title="Closes the current music score.">GuidoFactoryCloseMusic</a>(f);     <span class="comment">// extract the GAR handle</span>
    <a class="code" href="group__Engine.html#ga04ffb5395717ddda32863dfab77a1624">GuidoAR2GR</a>( ar, 0, &amp;gr );           <span class="comment">// and the GGR handle</span>
    <a class="code" href="group__Factory.html#gad79fc0c97df64fdb46c1240335410bc3" title="Closes the Guido Factory.">GuidoFactoryClose</a>(f);               <span class="comment">// close the GUIDO Factory which won&#39;t be used any more</span>

    <span class="keywordflow">if</span>( gr )                            <span class="comment">// check for the handle validity</span>
    {
        <span class="comment">// ... Do something with the GGR handle (i.e: draw)</span>
    }
}
</pre></div> </div>
<hr class="footer"/><address class="footer"><small>
Generated on Thu Oct 23 2014 11:56:58 for GUIDOLib by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.2 - © <a href="http://www.grame.fr/Recherche">Grame Research Lab.</a></small></address>
</body>
</html>
